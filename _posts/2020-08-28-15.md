---
layout: post
title: 20.08.28 - [LLVM] Control Flow 조작하기
date: 2020-08-28
Author: yarncha
categories:
tags: [LLVM]
comments: true
---

오늘의 목표

- [] Control Flow 간단하게라도 조작해보기

---------------

## control flow 간단하게라도 조작해보기

OLLVM의 [BogusControlFlow부분]을 참고해서 control flow를 조작해보기로.



### 2. 한 basicblock에 대해서 난독화 진행해보기


~발전할 수 있는 방안~
+ 저번 시간에 basicblock들의 이름을 출력하는 걸 해봤다. 이때 ㅇ름을 가져오는 것도 가능하니까 무슨 블럭이냐에 따라서 조절가능할수도있을것같음 (if에는 이거, for에는 이거 이런식으로?) 아니면 entry에는 항상 이거 적용하고 조건문에는 뭐~ 이런식
+홀수번째는 무조건 true, 짝수번째는 무조건 false opaque
+변형된 블럭에 연산자 변형 (+ -> -)(* -> / )이런식으로 변형이 가능할것같기도 하고 근데 br관련해서는 아직 아이디어 없음

-----------------------------------------------
<!-- ollvm에서의 bcf는 각 basicblock 앞에 opaque predicate를 이용한 새로운 bb를 넣는데, 이 bb에는 항상 참인 if문이 있어 언제나 기존의 bb로 점프하도록 한다. 다른 분기에는 기존의 bb를 clone하고 랜덤 junk로 채운 bb를 넣는다.-->

<!-- createAlteredBasicBlock
deep clone이 아닌 shallow clone
(가리키는 실체 객체는 복사를 안 하는 복사)
-> http://llvm.1065342.n5.nabble.com/Cloning-block-for-newbie-td46552.html
여기에서는 bb를 복사해서 이거를 변형하는 듯
이게 아니라 CloneBasicBlock 인듯하다


---------------------------------------------

<!-- References -->

[BogusControlFlow부분]: https://github.com/obfuscator-llvm/obfuscator/blob/llvm-4.0/lib/Transforms/Obfuscation/BogusControlFlow.cpp "bcf"
